<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>é‡é‡è¨“ç·´ç´€éŒ„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans TC', sans-serif;
      margin: 0;
      background-color: #f4f4f4;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
    }
    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      padding: 20px;
      flex: 1 1 400px;
      max-width: 500px;
    }
    form label {
      display: block;
      margin-top: 15px;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      width: 100%;
      margin-top: 20px;
      padding: 10px;
      background-color: #4A90E2;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
    }
    .summary-title {
      font-weight: bold;
      font-size: 1.2rem;
      margin-bottom: 10px;
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .data-card {
      background: #f9f9f9;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    .data-card .label {
      font-weight: bold;
      font-size: 0.95rem;
    }
    .data-card .value {
      font-size: 1.1rem;
      color: #333;
    }
  </style>
</head>
<body>
  <h1>é‡é‡è¨“ç·´ç´€éŒ„</h1>
  <div class="container">
    <div class="card">
      <form id="trainingForm">
        <label>è¨“ç·´æ—¥æœŸï¼š<input type="date" id="date"></label>
        <label>è¨“ç·´éƒ¨ä½ï¼š
          <select id="partSelect">
            <option value="">è«‹é¸æ“‡</option>
            <option value="è…¿éƒ¨">è…¿éƒ¨</option>
            <option value="èƒŒéƒ¨">èƒŒéƒ¨</option>
            <option value="èƒ¸éƒ¨">èƒ¸éƒ¨</option>
            <option value="è‚©éƒ¨">è‚©éƒ¨</option>
            <option value="æ‰‹è‡‚">æ‰‹è‡‚</option>
            <option value="æ ¸å¿ƒ">æ ¸å¿ƒ</option>
          </select>
        </label>
        <label>è¨“ç·´å‹•ä½œï¼š<select id="motionSelect"></select></label>
        <label>å–®æ¬¡é‡é‡ï¼ˆkgï¼‰ï¼š<input type="number" id="weight"></label>
        <label>æ¯çµ„æ¬¡æ•¸ï¼ˆrepsï¼‰ï¼š<input type="number" id="reps"></label>
        <label>çµ„æ•¸ï¼ˆsetsï¼‰ï¼š<input type="number" id="sets"></label>
        <label>ç¸½é‡é‡ï¼ˆè‡ªå‹•è¨ˆç®—ï¼‰ï¼š<input type="number" id="totalWeight" readonly></label>
        <label>ä¸»è§€ç–²å‹ï¼ˆRPEï¼‰ï¼š
          <select id="rpeSelect">
            <option value="">è«‹é¸æ“‡</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </label>
        <button type="submit">é€å‡ºç´€éŒ„</button>
      </form>
    </div>

    <div class="card">
      <div class="summary-title">ğŸ“Š è¨“ç·´ç´€éŒ„æ‘˜è¦</div>
      <div id="sheetData" class="grid">è®€å–ä¸­...</div>
    </div>
  </div>

  <script>
    const partSelect = document.getElementById('partSelect');
    const motionSelect = document.getElementById('motionSelect');
    const weightInput = document.getElementById('weight');
    const repsInput = document.getElementById('reps');
    const setsInput = document.getElementById('sets');
    const totalWeightInput = document.getElementById('totalWeight');
    const rpeSelect = document.getElementById('rpeSelect');
    const dateInput = document.getElementById('date');
    dateInput.value = new Date().toISOString().split('T')[0];

    const motionOptions = {
      "è…¿éƒ¨": ["æ·±è¹²", "ç¡¬èˆ‰", "è…¿æ¨"],
      "èƒŒéƒ¨": ["å¼•é«”å‘ä¸Š", "æ»‘è¼ªä¸‹æ‹‰"],
      "èƒ¸éƒ¨": ["æ§“éˆ´è‡¥æ¨", "å•éˆ´é£›é³¥"],
      "è‚©éƒ¨": ["è‚©æ¨", "å´å¹³èˆ‰"],
      "æ‰‹è‡‚": ["äºŒé ­å½èˆ‰", "ä¸‹å£“"],
      "æ ¸å¿ƒ": ["ä»°è‡¥èµ·å", "æ²è…¹", "æ£’å¼"]
    };

    partSelect.addEventListener('change', () => {
      const part = partSelect.value;
      motionSelect.innerHTML = '<option value="">è«‹é¸æ“‡è¨“ç·´å‹•ä½œ</option>';
      (motionOptions[part] || []).forEach(motion => {
        let opt = document.createElement('option');
        opt.value = motion;
        opt.textContent = motion;
        motionSelect.appendChild(opt);
      });
    });

    function calculateTotal() {
      const w = parseFloat(weightInput.value) || 0;
      const r = parseInt(repsInput.value) || 0;
      const s = parseInt(setsInput.value) || 0;
      totalWeightInput.value = (w * r * s).toFixed(1);
    }

    weightInput.addEventListener('input', calculateTotal);
    repsInput.addEventListener('input', calculateTotal);
    setsInput.addEventListener('input', calculateTotal);

    async function loadSheetData() {
      const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQL3qOJuvxEclz0Rc_5vvNGRt9F9zDoUNdeBY0hbgyrixMs1wh93UMlT5vUeYU4pzBuX_i_PFzQ1NDB/pub?gid=1510297865&single=true&output=csv";
      const keys = ["è…¿éƒ¨ç¸½é‡","èƒŒéƒ¨ç¸½é‡","èƒ¸éƒ¨ç¸½é‡","è‚©éƒ¨ç¸½é‡","æ‰‹è‡‚ç¸½é‡","æ·±è¹²ç¸½é‡","æ·±è¹²RM","ç¡¬èˆ‰ç¸½é‡","ç¡¬èˆ‰RM","æ§“éˆ´è‡¥æ¨ç¸½é‡","æ§“éˆ´è‡¥æ¨RM","å¼•é«”å‘ä¸Šæ¬¡æ•¸","æ»‘è¼ªä¸‹æ‹‰ç¸½é‡","æ»‘è¼ªä¸‹æ‹‰RM","æ§“éˆ´åˆ’èˆ¹ç¸½é‡","æ§“éˆ´åˆ’èˆ¹RM","æ²è…¹æ¬¡æ•¸"];
      try {
        const res = await fetch(csvUrl);
        const text = await res.text();
        const rows = text.trim().split("\n").map(r => r.split(","));
        const data = {};
        for (let i = 1; i < rows.length; i++) {
          const item = rows[i][0];
          const value = rows[i][1];
          if (keys.includes(item)) {
            data[item] = value;
          }
        }
		const iconMap = {
		  "è…¿éƒ¨ç¸½é‡": "ğŸ¦µ",
		  "èƒŒéƒ¨ç¸½é‡": "ğŸ’ª",
		  "èƒ¸éƒ¨ç¸½é‡": "ğŸ›ï¸",
		  "è‚©éƒ¨ç¸½é‡": "ğŸ§â€",
		  "æ‰‹è‡‚ç¸½é‡": "ğŸ’ª",
		  "æ·±è¹²ç¸½é‡": "ğŸ‹ï¸â€",
		  "æ·±è¹²RM": "ğŸ‹ï¸â€ğŸ¯",
		  "ç¡¬èˆ‰ç¸½é‡": "ğŸ†",
		  "ç¡¬èˆ‰RM": "ğŸ¯",
		  "æ§“éˆ´è‡¥æ¨ç¸½é‡": "ğŸ›ï¸",
		  "æ§“éˆ´è‡¥æ¨RM": "ğŸ›ï¸ğŸ¯",
		  "å¼•é«”å‘ä¸Šæ¬¡æ•¸": "ğŸ§—â€",
		  "æ»‘è¼ªä¸‹æ‹‰ç¸½é‡": "ğŸ£",
		  "æ»‘è¼ªä¸‹æ‹‰RM": "ğŸ£ğŸ¯",
		  "æ§“éˆ´åˆ’èˆ¹ç¸½é‡": "ğŸš£â€",
		  "æ§“éˆ´åˆ’èˆ¹RM": "ğŸš£ğŸ¯",
		  "æ²è…¹æ¬¡æ•¸": "ğŸ¤¸"
		};
        let html = "";
	keys.forEach(k => {
	  const icon = iconMap[k] || ""; // æ’å…¥ icon
	  html += `
	    <div class="data-card">
	      <div class="label">${icon} ${k}</div>
	      <div class="value">${data[k] || 'N/A'}</div>
	    </div>`;
	});
        document.getElementById("sheetData").innerHTML = html;
      } catch {
        document.getElementById("sheetData").innerHTML = 'âŒ è¼‰å…¥å¤±æ•—';
      }
    }
    loadSheetData();

    document.getElementById("trainingForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const formData = new FormData();
      formData.append("entry.1377173840", dateInput.value);
      formData.append("entry.1855437932", partSelect.value);
      formData.append("entry.168647639", motionSelect.value);
      formData.append("entry.606918952", weightInput.value);
      formData.append("entry.1939856150", repsInput.value);
      formData.append("entry.154070812", setsInput.value);
      formData.append("entry.856474848", totalWeightInput.value);
      formData.append("entry.130109099", rpeSelect.value);

      fetch("https://docs.google.com/forms/d/e/1FAIpQLSfdsGiw_hXbkMh7CKituuZRkcLCOXtaXPwmYkl0U0mDfMpm1w/formResponse", {
        method: "POST",
        mode: "no-cors",
        body: formData
      }).then(() => {
        alert("âœ… æˆåŠŸé€å‡ºè¨“ç·´ç´€éŒ„ï¼");
        document.getElementById("trainingForm").reset();
        dateInput.value = new Date().toISOString().split('T')[0];
        totalWeightInput.value = "";
      }).catch(() => {
        alert("âŒ é€å‡ºå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦");
      });
    });
  </script>
</body>
</html>
